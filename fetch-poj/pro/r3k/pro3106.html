<h2 align="center">Flip and Turn</h2></div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 2000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 1203</td><td width="10px"></td><td><b>Accepted:</b> 384</td></table></div><h3>Description</h3><div class="ptx" lang="en-US"><span lang="en-us"><p>Let us define a set of operations on a rectangular matrix of printable characters.</p><p>A matrix <i>A</i> with <i>m</i> rows (1-st index) and <i>n</i> columns (2-nd index) is given. The resulting matrix <i>B</i> is defined as follows.</p><ul><li>Transposition by the main diagonal (operation identifier is &lsquo;<code>1</code>&rsquo;): <i>B<sub>j</sub></i><sub>,<i>i</i></sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Transposition by the second diagonal (&lsquo;<code>2</code>&rsquo;): <i>B<sub>n</sub></i><sub>&minus;<i>j</i>+1,<i>m</i>&minus;<i>i</i>+1</sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Horizontal flip (&lsquo;<code>H</code>&rsquo;): <i>B</i><sub><i>m</i>&minus;<i>i</i>+1,<i>j</i></sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Vertical flip (&lsquo;<code>V</code>&rsquo;): <i>B<sub>i</sub></i><sub>,<i>n</i>&minus;<i>j</i>+1</sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Rotation by 90 (&lsquo;<code>A</code>&rsquo;), 180 (&lsquo;<code>B</code>&rsquo;), or 270 (&lsquo;<code>C</code>&rsquo;) degrees clockwise; 90 degrees case: <i>B<sub>j</sub></i><sub>,<i>m</i>&minus;<i>i</i>+1</sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Rotation by 90 (&lsquo;<code>X</code>&rsquo;), 180 (&lsquo;<code>Y</code>&rsquo;), or 270 (&lsquo;<code>Z</code>&rsquo;) degrees counterclockwise; 90 degrees case: <i>B<sub>n</sub></i><sub>&minus;<i>j</i>+1,<i>i</i></sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li></ul><p>You are given a sequence of no more than 100 000 operations from the set. Apply the operations to the given matrix and output the resulting matrix.</p></span></div><h3>Input</h3><div class="ptx" lang="en-US"><span lang="en-us"><p>At the first line of the input file there are two integer numbers &mdash; <i>m</i> and <i>n</i> (0 &lt; <i>m</i>, <i>n</i> &le; 300). Then there are <i>m</i> lines with <i>n</i> printable characters per line (we define a printable character as a symbol with ASCII code from 33 to 126 inclusive). There will be no additional symbols at these lines.</p><p>The next line contains the sequence operations to be performed, specified by their one-character identifiers. The operations should be performed from left to right.</p></span></div><h3>Output</h3><div class="ptx" lang="en-US"><p>Two integer numbers, the number of rows and columns in the output matrix. Then the output matrix must follow, in the same format as the input one.</p></div><h3>Sample Input</h3><pre class="sio">3 4
0000
a0b0
cdef
A1</pre><h3>Sample Output</h3><pre class="sio">3 4
cdef
a0b0
0000</pre><h3>Source</h3><div class="ptx" lang="en-US"><a>Northeastern Europe 2005</a>, Northern Subregion</div></td></tr></table>

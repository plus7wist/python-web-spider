<h2 align="center">Balancing the Scale</h2></div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 1649</td><td width="10px"></td><td><b>Accepted:</b> 634</td></table></div><h3>Description</h3><div class="ptx" lang="en-US"><span lang="en-us"><p>You are given a strange scale (see the figure below), and you are wondering how to balance this scale. After several attempts, you have discovered the way to balance it &mdash; you need to put different numbers on different squares while satisfying the following two equations:</p><div align="center"><table border="0" width="600"><tr><td align="center" width="10%"><i>x</i><sub>1</sub> * 4</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>2</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>3</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="4%"><i>x</i><sub>4</sub></td><td align="center" width="4%">=</td><td align="center" width="4%"><i>x</i><sub>5</sub></td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>6</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>7</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>8</sub> * 4</td></tr><tr><td align="center" width="10%"><i>y</i><sub>1</sub> * 4</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>2</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>3</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="4%"><i>y</i><sub>4</sub></td><td align="center" width="4%">=</td><td align="center" width="4%"><i>y</i><sub>5</sub></td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>6</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>7</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>8</sub> * 4</td></tr></table></div><p>How many ways can you balance this strange scale with the given numbers?</p></span><img src="images/3139_1.png" align="right" hspace="10" vspace="10"></div><h3>Input</h3><div class="ptx" lang="en-US"><p>There are multiple test cases in the input file. Each test case consists of 16 distinct numbers in the range [1, 1024] on one separate line. You are allowed to use each number only once.</p><p>A line with one single integer 0 indicates the end of input and should not be processed by your program.</p></div><h3>Output</h3><div class="ptx" lang="en-US"><p>For each test case, if it is possible to balance the scale in question, output one number, the number of different ways to balance this scale, in the format as indicated in the sample output. Rotations and reversals of the same arrangement should be counted only once.</p></div><h3>Sample Input</h3><pre class="sio">87 33 98 83 67 97 44 72 91 78 46 49 64 59 85 88
0</pre><h3>Sample Output</h3><pre class="sio">Case 1: 15227223</pre><h3>Source</h3><div class="ptx" lang="en-US"><a>Shanghai 2006</a></div></td></tr></table>
